!function(){angular.module("angular-jwt-auth",["angular-jwt","angular-jwt-auth.credentials","angular-ws-service","LocalStorageModule"]).config(["$httpProvider","jwtInterceptorProvider","credentialsServiceProvider",function(e,t,n){t.tokenGetter=function(e,t,r,o){if(".html"===e.url.substr(e.url.length-5))return null;var i=n.existingTokenRetriever();return null!==i.token&&t.isTokenExpired(i.token)?r({url:n.urlTokenRefresh,skipAuthorization:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:o.objectToURLEncoded,ignoreAuthModule:!0,method:"POST",data:{refresh_token:i.refreshToken}}).then(function(e){var t=e.data;return n.tokenSaver(t),t.token},function(){return null}):i.token},e.interceptors.push("jwtInterceptor")}]).run(["$rootScope","authService","credentialsService",function(e,t,n){e.$on("event:auth-loginRequired",function(){var e=n.credentialsRetriever();null!==e&&n.tokenRetriever({_username:e.username,_password:e.password}).then(function(e){var n=e.data;t.loginConfirmed(n,function(e){return e.headers.Authorization="Bearer "+n.token,e})},function(){t.loginCancelled()})})}]).run(["$rootScope","credentialsService",function(e,t){e.$on("event:auth-loginConfirmed",function(e,n){t.tokenSaver(n)}),e.$on("event:auth-loginCancelled",function(){t.tokenRemover()})}]),angular.module("angular-jwt-auth.credentials",[]).provider("credentialsService",function(){this.urlLoginCheck="/login_check",this.urlTokenRefresh="/token/refresh",this.credentialsRetriever=function(){},this.existingTokenRetriever=function(){},this.tokenRetriever=function(){},this.tokenSaver=function(){},this.tokenRemover=function(){},this.$get=function(){return{credentialsRetriever:this.credentialsRetriever,tokenRetriever:this.tokenRetriever,existingTokenRetriever:this.existingTokenRetriever,tokenSaver:this.tokenSaver,tokenRemover:this.tokenRemover}}}).config(["credentialsServiceProvider",function(e){e.credentialsRetriever=function(e){return null===localStorage.getItem("auth.username")||null===localStorage.getItem("auth.password")?null:{username:e.get("auth.username"),password:e.get("auth.password")}},e.tokenSaver=function(e){e.set("auth.jwt_token",this.token),e.set("auth.jwt_refresh_token",this.refresh_token)},e.existingTokenRetriever=function(e){return{token:e.get("auth.jwt_token"),refreshToken:e.get("auth.jwt_refresh_token")}},e.tokenRemover=function(e){e.remove("auth.jwt_token","auth.jwt_refresh_token")},e.tokenRetriever=function(t,n){return t.post(e.urlLoginCheck,this,{ignoreAuthModule:!0,skipAuthorization:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:n.objectToURLEncoded})}}])}();